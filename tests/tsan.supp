# ThreadSanitizer Suppression File for Agim
# ==========================================
#
# These suppressions are for known benign races that don't occur in production.

# test_gc_concurrent.c - test_cow_during_gc
# This test intentionally shares a Heap across multiple threads to stress-test
# COW operations. In production, each Block has its own Heap that is only
# accessed by a single thread (the worker executing that block).
# Per CLAUDE.md: "Heap counters aren't atomic - Each heap is accessed by a
# single thread via TLS. Atomics would add overhead with no benefit."
race:heap_alloc
race:cow_gc_thread
race:cow_modifier_thread

# The test is validating COW semantics, not heap thread-safety.
# The "race" is benign because:
# 1. Production code never shares heaps across threads
# 2. The test still validates COW correctness despite the race
race:test_cow_during_gc
